"use strict";function newElement(e,t){var n=document.createElement(e);return n.className=t,n}function Tube(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.element=newElement("div","tube");var t=newElement("div","tube__border"),n=newElement("div","tube__body");this.element.appendChild(e?n:t),this.element.appendChild(e?t:n),this.setHeight=function(e){return n.style.height=e+"px"}}function Tubes(e,t,n){var i=this;this.element=newElement("div","tubes"),this.topTube=new Tube(!0),this.bottomTube=new Tube(!1),this.element.appendChild(this.topTube.element),this.element.appendChild(this.bottomTube.element),this.gapSort=function(){var n=Math.random()*(e-t),s=e-t-n;i.topTube.setHeight(n),i.bottomTube.setHeight(s)},this.getX=function(){return parseInt(i.element.style.left.split("px")[0])},this.setX=function(e){return i.element.style.left=e+"px"},this.getWidth=function(){return i.element.clientWidth},this.gapSort(),this.setX(n)}function TubesFactory(e,t,n,i,s){var r=this;this.coupleTubes=[new Tubes(e,n,t),new Tubes(e,n,t+i),new Tubes(e,n,t+2*i),new Tubes(e,n,t+3*i)];var o=3;this.animate=function(){r.coupleTubes.forEach(function(e){e.setX(e.getX()-3),e.getX()<-e.getWidth()&&(e.setX(e.getX()+i*r.coupleTubes.length),e.gapSort());var n=t/2;e.getX()+3>=n&&e.getX()<n&&s()})}}function Bird(e){var t=this,n=!1,i="bird.png",s=window;this.element=newElement("img","bird"),this.element.src="./resources/images/bird.png",this.getY=function(){return parseInt(t.element.style.bottom.split("px")[0])},this.setY=function(e){return t.element.style.bottom=e+"px"},s.onkeydown=function(e){return n=!0},s.onkeyup=function(e){return n=!1},this.animate=function(){var i=t.getY()+(n?5:-5),s=e-t.element.clientHeight;i<=0?t.setY(0):i>=s?t.setY(s):t.setY(i)},this.setY(e/2)}function Progress(){var e=newElement("div","progress"),t=newElement("p","progress__title"),n=newElement("span","progress__score");this.element=e,e.appendChild(t),t.innerHTML="SCORE",e.appendChild(n),this.updateScore=function(e){n.innerHTML=e},this.updateScore(0)}function hasCollision(e,t){var n=e.getBoundingClientRect(),i=t.getBoundingClientRect(),s=n.left+n.width>=i.left&&i.left+i.width>=n.left,r=n.top+n.height>=i.top&&i.top+i.height>=n.top;return s&&r}function hasCrashed(e,t){var n=!1;return t.coupleTubes.forEach(function(t){if(!n){var i=t.topTube.element,s=t.bottomTube.element;n=hasCollision(e.element,i)||hasCollision(e.element,s)}}),n}function VermyBird(){var e=0,t=document.querySelector("[vgn-bird]"),n=t.clientHeight,i=t.clientWidth,s=new Progress,r=new TubesFactory(n,i,200,400,function(){return s.updateScore(++e)}),o=new Bird(n);t.appendChild(s.element),t.append(o.element),r.coupleTubes.forEach(function(e){return t.appendChild(e.element)}),this.start=function(){var e=setInterval(function(){r.animate(),o.animate(),hasCrashed(o,r)&&(console.log("crashed"),clearInterval(e))},20)}}(new VermyBird).start();